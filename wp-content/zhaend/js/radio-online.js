document.addEventListener("DOMContentLoaded",()=>{if(location.hostname!==zhaendblog)return;const g="0",u=`https://docs.google.com/spreadsheets/d/1${id}g/gviz/tq?tqx=out:json&tq&gid=${g}`;function l(){if(typeof zhaendcss!="undefined"&&zhaendcss==="zhaend"){if(!document.querySelector('link[href*="mediaelementplayer"]')){let e=document.createElement("link");e.rel="stylesheet";e.href="https://cdnjs.cloudflare.com/ajax/libs/mediaelement/4.2.16/mediaelementplayer.min.css";document.head.appendChild(e);}if(!document.querySelector('script[src*="mediaelement-and-player.min.js"]')){let e=document.createElement("script");e.src="https://cdnjs.cloudflare.com/ajax/libs/mediaelement/4.2.16/mediaelement-and-player.min.js";document.body.appendChild(e);}}}function r({img:e,link:t,title:a,desc:o},i){const d=document.createElement("div");return d.className="ritem mb-2 rounded",d.dataset.link=t,d.innerHTML=`<img class="img-thumbnail rounded-circle" src="${e.replace(/h120/g,"s300")}" alt="Escucha ${a}"><img src="${i}" alt="Botón play" class="playb" role="button" aria-label="Reproducir ${a}"><br><label><strong>${a}</strong></label><label class="d-none">${o}</label>`,d}function p({link:e,title:t,desc:a,imgUrl:o}){if(typeof zhlink!="undefined"&&zhlink==="zhaend.net"){const i=document.createElement("div");i.className="card";const d=document.createElement("div");d.className="card-body";const n=document.createElement("li");n.className="list-group-item d-flex align-items-start border-0 ps-0 pe-0";const s=Object.assign(document.createElement("img"),{className:"img-thumbnail rounded-3 my-2 me-3",src:o,alt:t});const m=document.createElement("div");m.className="flex-grow-1";const h=Object.assign(document.createElement("h5"),{className:"card-title mb-1",textContent:t});const c=Object.assign(document.createElement("div"),{className:"card-text mb-1 ps-2",textContent:a});const f=Object.assign(document.createElement("div"),{className:"cargando card-text ps-2 text-muted",textContent:"Cargando..."});const b=Object.assign(document.createElement("button"),{className:"btn btn-sm btn-outline-secondary me-1 close-button",textContent:"X"});const g=Object.assign(document.createElement("button"),{className:"btn btn-sm btn-outline-secondary minimize-button",textContent:"–"});m.append(h,c,f,b,g),n.append(s,m);const y=document.createElement("div");y.className="text-center mt-2";const v=document.createElement("audio");v.controls=!0,v.autoplay=!0,v.className="w-100";const x=document.createElement("source");x.src=e,x.type="audio/mpeg",v.appendChild(x),y.appendChild(v),d.append(n,y),i.appendChild(d);const R=document.querySelector("#reproductor");R.classList.remove("minimized"),R.innerHTML="",R.appendChild(i),R.classList.add("show"),new MediaElementPlayer(v,{success:T=>{const k=setTimeout(()=>{f.textContent="La radio no está disponible ahora",T.remove()},2e4);T.addEventListener("canplaythrough",()=>{clearTimeout(k),f.textContent="En vivo desde zhaend.net",f.classList.replace("text-muted","text-success"),f.classList.add("text-uppercase"),f.classList.remove("cargando")}),T.addEventListener("error",()=>{clearTimeout(k),f.textContent="La radio no está disponible ahora",v.style.display="none",f.classList.remove("text-success","text-uppercase","cargando"),f.classList.replace("text-muted","text-danger")})}}),b.addEventListener("click",()=>R.innerHTML=""),g.addEventListener("click",()=>{R.classList.toggle("minimized"),i.style.backgroundColor=R.classList.contains("minimized")?"rgb(0,0,0)":""})}}function m(e){const t=JSON.parse(e).table.rows.slice(1);if(!t.length)return;for(let a=t.length-1;a>0;a--){let o=Math.floor(Math.random()*(a+1));[t[a],t[o]]=[t[o],t[a]]}const a=document.querySelector(".znd");t.forEach(o=>{const [i,d,n,s]=o.c.map(v=>v?.v||"");a.appendChild(r({img:i,link:d,title:n,desc:s},imgplay))}),a.addEventListener("click",o=>{const i=o.target.closest(".ritem");if(!i)return;const d=i.dataset.link,n=i.querySelector("strong").textContent,s=i.querySelector("label:last-of-type").textContent,c=i.querySelector(".img-thumbnail").src.replace(/s300/g,"s50");p({link:d,title:n,desc:s,imgUrl:c})})}l(),typeof zhradio!="undefined"&&zhradio===0&&fetch(u).then(e=>e.text()).then(e=>m(e.substring(47).slice(0,-2))).catch(e=>console.error("Error cargando radios:",e))})
